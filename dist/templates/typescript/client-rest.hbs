/**
 * Generated API Client
 * This file was auto-generated by GIDEVO API Tool
 * Do not edit manually
 */

import axios, { AxiosInstance, AxiosRequestConfig, AxiosResponse } from 'axios';

export interface ApiClientConfig {
  baseURL: string;
  token?: string;
  timeout?: number;
  headers?: Record<string, string>;
}

export interface ApiResponse<T> {
  data: T;
  status: number;
  headers: Record<string, string>;
}

export class ApiClient {
  private client: AxiosInstance;

  constructor(config: ApiClientConfig | string, token?: string) {
    const baseURL = typeof config === 'string' ? config : config.baseURL;
    const configToken = typeof config === 'string' ? token : config.token;
    const timeout = typeof config === 'string' ? 30000 : (config.timeout || 30000);
    const extraHeaders = typeof config === 'string' ? {} : (config.headers || {});

    this.client = axios.create({
      baseURL,
      timeout,
      headers: {
        'Content-Type': 'application/json',
        ...(configToken ? { Authorization: `Bearer ${configToken}` } : {}),
        ...extraHeaders
      }
    });

    // Response interceptor for error handling
    this.client.interceptors.response.use(
      (response) => response,
      (error) => {
        if (error.response) {
          const message = error.response.data?.message || error.message;
          throw new Error(`API Error ${error.response.status}: ${message}`);
        }
        throw error;
      }
    );
  }

  /**
   * Set authorization token
   */
  setToken(token: string): void {
    this.client.defaults.headers.common['Authorization'] = `Bearer ${token}`;
  }

  /**
   * Remove authorization token
   */
  clearToken(): void {
    delete this.client.defaults.headers.common['Authorization'];
  }

  /**
   * GET request
   */
  async get<T>(path: string, config?: AxiosRequestConfig): Promise<T> {
    const response = await this.client.get<T>(path, config);
    return response.data;
  }

  /**
   * POST request
   */
  async post<T>(path: string, data?: any, config?: AxiosRequestConfig): Promise<T> {
    const response = await this.client.post<T>(path, data, config);
    return response.data;
  }

  /**
   * PUT request
   */
  async put<T>(path: string, data?: any, config?: AxiosRequestConfig): Promise<T> {
    const response = await this.client.put<T>(path, data, config);
    return response.data;
  }

  /**
   * PATCH request
   */
  async patch<T>(path: string, data?: any, config?: AxiosRequestConfig): Promise<T> {
    const response = await this.client.patch<T>(path, data, config);
    return response.data;
  }

  /**
   * DELETE request
   */
  async delete<T>(path: string, config?: AxiosRequestConfig): Promise<T> {
    const response = await this.client.delete<T>(path, config);
    return response.data;
  }

  /**
   * Get raw response with headers and status
   */
  async request<T>(config: AxiosRequestConfig): Promise<ApiResponse<T>> {
    const response = await this.client.request<T>(config);
    return {
      data: response.data,
      status: response.status,
      headers: response.headers as Record<string, string>
    };
  }

  // ============================================
  // Generated API Methods
  // ============================================

{{#each paths}}
{{#each this}}
  /**
   * {{summary}}
   * {{#if description}}{{description}}{{/if}}
   * @path {{@../key}}
   */
  async {{methodName @key @../key}}({{#if (eq @key 'post')}}data?: any{{else if (eq @key 'put')}}data?: any{{else if (eq @key 'patch')}}data?: any{{/if}}): Promise<any> {
    {{#if (eq @key 'get')}}
    return this.get('{{@../key}}');
    {{else if (eq @key 'post')}}
    return this.post('{{@../key}}', data);
    {{else if (eq @key 'put')}}
    return this.put('{{@../key}}', data);
    {{else if (eq @key 'patch')}}
    return this.patch('{{@../key}}', data);
    {{else if (eq @key 'delete')}}
    return this.delete('{{@../key}}');
    {{/if}}
  }

{{/each}}
{{/each}}
}

export default ApiClient;
